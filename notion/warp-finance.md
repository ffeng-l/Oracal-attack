# Warp Finance

## 报道

{% embed url="https://www.bishijie.com/shendu/154966.html" %}

## 概述

1. Warp Finance使用的是Uniswap交易对的相对价格作为其预言机的喂价源。
2. 攻击者在了解到这个情况后，使用从闪电贷中获取的巨额资金操纵了Uniswap交易对的价格。
3. 通过控制预言机喂价源信息，攻击者破坏了Warp Finance的借款价值判断标准。
4. 在Warp Finance错误的数据环境下，攻击者窃取了远远超过抵押品价值的资产。
5. 攻击者归还了从闪电贷中借出的款项。

## 步骤

### 1. 闪电贷

通过闪电贷，攻击者从 uniswap 和 dydx 处共借得5笔贷款，每笔借出的`WETH`和`DAI`数目如下：

![](<../.gitbook/assets/image (3).png>)

借出的资金规模已高达近2亿美元。

### 2. 操纵价格

攻击者向Uniswap的DAI 2交易池中注入流动性（`WETH`和`DAI`），获取了流动性代币LP token。然后，将所获的LP代币抵押在Warp Finance合约中。

完成抵押后，攻击者利用借来的资金，将Uniswap DAI 2池中的`DAI`兑换殆尽。

根据价格计算公式（略），LP token的价格被抬高非常多，价格已处于被操纵状态。即攻击者抵押的LP token的价格被抬高。

因此，攻击者可以用借出相比正常量更多的资产。

### 3. 贷款

在成功控制抵押价格后，攻击者便能利用错误的价格数据贷出远远超过抵押品价值的资产，从中获取暴利。最后，攻击者归还了闪电贷的款项。

## 总结

一起典型的由闪电贷巨款发起的预言机攻击事件。没有出现不一致。
